<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ztGantt</title>
    <link rel="stylesheet" href="./style.css" />
    <link rel="stylesheet" href="./gantt.css" />
    <link rel="stylesheet" href="./zt-tour/zt-tour.css" />
    <!-- <link rel="stylesheet" href="./theme/dark.css" /> -->
    <link
      rel="shortcut icon"
      href="./images/ztGanttLogo.png"
      type="image/x-icon"
    />
    <script src="./gantt.js"></script>
  </head>
  <body>
    <div class="zt-gantt-d-flex action-container"> 
      <div class="collapse-container">
        <span>Collapse</span>
        <input
          type="checkbox"
          id="collapse-switch"
          onchange="changeCollapse(event)"
        />
        <label for="collapse-switch">collapse</label>
      </div>

      <div class="collapse-container today-container">
        <span>Today</span>
        <input
          type="checkbox"
          id="today-switch"
          checked="true"
          onchange="changeToday(event)"
        />
        <label for="today-switch">Today</label>
      </div>
      <div class="export-data">
        <select
          class="export"
          id="export"
          placeholder="Export"
          onchange="exportChange(event)"
        >
          <option value="" disabled="" selected="">Export</option>
          <option value="png">Export To PNG</option>
          <option value="pdf">Export To PDF</option>
          <option value="excel">Export To Excel</option>
        </select>
      </div>
      <div class="fullscreen">
        <button class="btn" onclick="changeScreen()">FullScreen</button>
      </div>
      <div class="auto-scheduling">
        <!-- <span class="coming-soon">coming soon</span> -->
        <button class="btn" onclick="autoScheduling()">Auto Scheduling</button>
      </div>
      <div class="zoom">
        <select
          class="scale-zoom"
          id="scale_zoom"
          placeholder="Zoom to"
          onchange="changeZoom(event)"
        >
          <option value="" disabled="">Zoom to:</option>
          <option value="year">Years</option>
          <option value="quarter">Quarters</option>
          <option value="month">Months</option>
          <option value="week">Weeks</option>
          <option value="day" selected="day">Days</option>
          <option value="hour">Hour</option>
        </select>
      </div>
      <div class="Language">
        <select
          class="lang"
          id="lang"
          placeholder="Select Language"
          onchange="changeLang(event)"
        >
          <option value="" disabled="" selected="">Select Language:</option>
          <option value="ar">Arabic</option>
          <option value="be">Belarusian</option>
          <option value="en" selected="en">English</option>
          <option value="ca">Catalan</option>
          <option value="cn">Chinese</option>
          <option value="hr">Croatian</option>
          <option value="cs">Czech</option>
          <option value="da">Danish</option>
          <option value="nl">Dutch</option>
          <option value="fi">Finnish</option>
          <option value="fr">French</option>
          <option value="de">German</option>
          <option value="el">Greek</option>
          <option value="he">Hebrew</option>
          <option value="hi">Hindi (India)</option>
          <option value="hu">Hungarian</option>
          <option value="id">Indonesian</option>
          <option value="it">Italian</option>
          <option value="ja">Japanese</option>
          <option value="kr">Korean</option>
          <option value="no">Norwegian</option>
          <option value="fa">Persian</option>
          <option value="pl">Polish</option>
          <option value="pt">Portuguese</option>
          <option value="ro">Romanian</option>
          <option value="ro">Russian</option>
          <option value="sk">Slovak</option>
          <option value="si">Slovenian</option>
          <option value="es">Spanish</option>
          <option value="sv">Swedish</option>
          <option value="tr">Turkish</option>
          <option value="ua">Ukrainian</option>
        </select>
      </div>

      <div class="dark-mode">
        <span>Dark Mode</span>
        <input
        type="checkbox"
        id="toggle"
        onchange="changeTheme(event)"
        class="toggle--checkbox"
        />
        <label for="toggle" class="toggle-theme"> </label>
      </div>
      <div class="fullscreen">
        <button class="btn" style="margin-left: 10px" onclick="startTour()">
          Start Tour
        </button>
        <svg class="hint-icon" width="18px" height="18px" style="margin-bottom: -4px;" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path fill="#55A5FF" d="M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm23.744 191.488c-52.096 0-92.928 14.784-123.2 44.352-30.976 29.568-45.76 70.4-45.76 122.496h80.256c0-29.568 5.632-52.8 17.6-68.992 13.376-19.712 35.2-28.864 66.176-28.864 23.936 0 42.944 6.336 56.32 19.712 12.672 13.376 19.712 31.68 19.712 54.912 0 17.6-6.336 34.496-19.008 49.984l-8.448 9.856c-45.76 40.832-73.216 70.4-82.368 89.408-9.856 19.008-14.08 42.24-14.08 68.992v9.856h80.96v-9.856c0-16.896 3.52-31.68 10.56-45.76 6.336-12.672 15.488-24.64 28.16-35.2 33.792-29.568 54.208-48.576 60.544-55.616 16.896-22.528 26.048-51.392 26.048-86.592 0-42.944-14.08-76.736-42.24-101.376-28.16-25.344-65.472-37.312-111.232-37.312zm-12.672 406.208a54.272 54.272 0 0 0-38.72 14.784 49.408 49.408 0 0 0-15.488 38.016c0 15.488 4.928 28.16 15.488 38.016A54.848 54.848 0 0 0 523.072 768c15.488 0 28.16-4.928 38.72-14.784a51.52 51.52 0 0 0 16.192-38.72 51.968 51.968 0 0 0-15.488-38.016 55.936 55.936 0 0 0-39.424-14.784z"></path></g></svg>
      </div>
      <!-- <button onclick="ZT_Gantt.destroy()">destroy</button>
      <button onclick="ZT_Gantt.render()">render</button> -->
      <!-- <button onclick="addCol()">Add Column</button>
      <button onclick="removeCol()">Remove Column</button> -->
      <input
        type="search"
        placeholder="Search Task"
        id="gantt-search"
        name="gantt-search"
        class="gantt-search"
        onkeyup="searchTask(event)"
      />
    </div>
    <div id="ZT-Gantt"></div>
  </div>
  <script src="./zt-tour/zt-tour.js"></script>
    <script>
      let data = [
        { id: 1, text: "Project 1", parent: 0, progress: 30 },
        {
          id: 2,
          text: "Task #2",
          start_date: "09-05-2023",
          end_date: "09-05-2023",
          parent: 1,
          progress: 50,
        },
        {
          id: 23,
          text: "Final Milestone",
          start_date: "09-17-2023",
          end_date: "09-17-2023",
          parent: 1,
          type: "milestone",
        },
        {
          id: 3,
          text: "Task #3",
          start_date: "09-03-2023",
          end_date: "09-07-2023",
          parent: 1,
          progress: 60,
        },
        {
          id: 5,
          text: "SubTask #5",
          start_date: "09-04-2023",
          end_date: "09-06-2023",
          parent: 3,
          progress: 20,
        },
        {
          id: 6,
          text: "SubTask #6",
          start_date: "09-06-2023",
          end_date: "09-09-2023",
          parent: 3,
          progress: 10,
        },
        {
          id: 7,
          text: "SubTask #7",
          start_date: "09-08-2023",
          end_date: "09-11-2023",
          parent: 3,
          progress: 50,
        },
        {
          id: 4,
          text: "Task #4",
          start_date: "09-13-2023",
          end_date: "09-16-2023",
          parent: 1,
          progress: 90,
        },
        { id: 8, text: "Project 2", parent: 0, progress: 80 },
        {
          id: 12,
          text: "Task #12",
          start_date: "09-03-2023",
          end_date: "09-05-2023",
          parent: 8,
          progress: 50,
        },
        {
          id: 25,
          text: "Next Milestone",
          start_date: "09-20-2023",
          end_date: "09-20-2023",
          parent: 8,
          type: "milestone",
        },
        {
          id: 13,
          text: "Task #13",
          start_date: "09-04-2023",
          end_date: "09-07-2023",
          parent: 8,
        },
        {
          id: 14,
          text: "Task #14",
          start_date: "09-05-2023",
          end_date: "09-09-2023",
          parent: 8,
        },
        {
          id: 15,
          text: "Task #15",
          start_date: "09-07-2023",
          end_date: "09-08-2023",
          parent: 8,
        },
        { id: 9, text: "Project 3", parent: 0, progress: 10 },
        {
          id: 16,
          text: "Task #16",
          start_date: "09-05-2023",
          end_date: "09-09-2023",
          parent: 9,
        },
        {
          id: 17,
          text: "Task #17",
          start_date: "09-06-2023",
          end_date: "09-08-2023",
          parent: 9,
        },
        { id: 10, text: "Project 4", parent: 0, progress: 40 },
        {
          id: 18,
          text: "Task #18",
          start_date: "09-08-2023",
          end_date: "09-16-2023",
          parent: 10,
        },
        {
          id: 19,
          text: "Task #19",
          start_date: "09-02-2023",
          end_date: "09-09-2023",
          parent: 10,
        },
        {
          id: 20,
          text: "Task #20",
          start_date: "09-11-2023",
          end_date: "09-13-2023",
          parent: 10,
        },
        { id: 11, text: "Project 5", parent: 0, progress: 100 },
        {
          id: 21,
          text: "Task #21",
          start_date: "09-04-2023",
          end_date: "09-10-2023",
          parent: 11,
        },
        {
          id: 22,
          text: "Task #22",
          start_date: "09-06-2023",
          end_date: "09-12-2023",
          parent: 11,
        },
      ];

      // let parents = [1]//,8,9,10,11]
      // for(let i = 0; i < parents.length; i++){
      //   for(let j = 0; j < 100; j++){
      //     let task =  {
      //     id: `task-${parents[i]}-${j}`,
      //     text: "Test #Task",
      //     start_date: "06-05-2023",
      //     end_date: "06-05-2023",
      //     parent: parents[i],
      //     progress: 50,
      //   }
      //   data.push(task);
      //   }
      // }

      let element = document.getElementById("ZT-Gantt");
      let ZT_Gantt = new ztGantt(element);

      ZT_Gantt.options.columns = [
        {
          name: "text",
          width: 245,
          min_width: 80,
          max_width: 300,
          tree: true,
          label: "Task Name",
          resize: true,
          template: (task) => {
            return `<span>${task.text}</span>`;
          },
        },
        {
          name: "progress",
          width: 245,
          min_width: 80,
          max_width: 300,
          tree: false,
          label: "Progress",
          resize: true,
          align: "center",
          template: (task) => {
            return `<span>${task.progress || 0}</span>`;
          },
        },
      ];

      ZT_Gantt.options.date_format = "%m-%d-%Y";
      ZT_Gantt.options.localLang = "en";
      ZT_Gantt.options.data = data;
      ZT_Gantt.options.collapse = false;
      ZT_Gantt.options.weekends = ["Sat", "Sun"];
      ZT_Gantt.options.fullWeek = true;
      ZT_Gantt.options.todayMarker = true;
      ZT_Gantt.options.updateLinkOnDrag = true;
      ZT_Gantt.options.splitTask = false;
      // ZT_Gantt.templates.showLightBox = false;
      ZT_Gantt.options.addLinks = (task) => {
        if (task.parent === 0) {
          return false;
        }
        return true;
      };

      ZT_Gantt.options.exportApi = "https://zt-gantt.zehntech.net/";
      // ZT_Gantt.options.exportApi = "http://192.168.0.155:8300/";
      ZT_Gantt.options.taskColor = true;
      ZT_Gantt.options.taskOpacity = 0.7;
      ZT_Gantt.options.links = [
        { id: 1, source: 2, target: 23, type: 1 },
        { id: 2, source: 3, target: 6, type: 2 },
        { id: 3, source: 4, target: 23, type: 3 },
        { id: 4, source: 12, target: 15 },
      ];
      ZT_Gantt.options.weekStart = 1; // set the start of the week
      ZT_Gantt.options.sidebarWidth = 300;
      ZT_Gantt.options.scales = [
        {
          unit: "week",
          step: 1,
          format: (t) => {
            const { startDate: a, endDate: n, weekNum: i } = weekStartAndEnd(t);
            return ` ${ZT_Gantt.formatDateToString(
              "%j %M",
              a
            )} - ${ZT_Gantt.formatDateToString(
              "%j %M",
              n
            )}, ${a.getFullYear()}`;
          },
        },
        { unit: "day", step: 1, format: "%d %D" },
      ];

      ZT_Gantt.options.zoomLevel = "day";

      // zoom config
      ZT_Gantt.options.zoomConfig = {
        levels: [
          {
            name: "hour",
            scale_height: 27,
            min_col_width: 550,
            scales: [
              { unit: "day", step: 1, format: "%d %M" },
              { unit: "hour", step: 1, format: "%H" },
            ],
          },
          {
            name: "day",
            scale_height: 27,
            min_col_width: 80,
            scales: [
              { unit: "week", step: 1, format: "%W" },
              { unit: "day", step: 1, format: "%d %M" },
            ],
          },
          {
            name: "week",
            scale_height: 45,
            min_col_width: 50,
            scales: [
              { unit: "month", step: 1, format: "%M" },
              {
                unit: "week",
                step: 1,
                format: (t) => {
                  const {
                    startDate: a,
                    endDate: n,
                    weekNum: i,
                  } = weekStartAndEnd(t);
                  return ` ${ZT_Gantt.formatDateToString(
                    "%j %M",
                    a
                  )} - ${ZT_Gantt.formatDateToString(
                    "%j %M",
                    n
                  )}, ${a.getFullYear()}`;
                },
              },
            ],
          },
          {
            name: "month",
            scale_height: 30,
            min_col_width: 120,
            scales: [
              { unit: "year", step: 1, format: "%Y" },
              { unit: "month", step: 1, format: "%M" },
            ],
          },
          {
            name: "quarter",
            scale_height: 25,
            min_col_width: 90,
            scales: [
              { unit: "year", step: 1, format: "%Y" },
              { unit: "quarter", step: 1, format: "Q%q" },
              { unit: "month", format: "%M" },
            ],
          },
          {
            name: "year",
            scale_height: 30,
            min_col_width: 30,
            scales: [
              { unit: "year", step: 3, format: "2022 - 2024" },
              { unit: "year", step: 1, format: "%Y" },
            ],
          },
        ],
      };

      ZT_Gantt.options.scale_height = 30;
      ZT_Gantt.options.row_height = 24;
      ZT_Gantt.options.minColWidth = 80;
      ZT_Gantt.options.addTaskOnDrag = true;
      ZT_Gantt.options.taskProgress = true;

      // Gantt layout to implement columns in right side
      // ZT_Gantt.options.rightGrid = [
      // {
      //     name: "text",
      //     width: 245,
      //     min_width: 80,
      //     max_width: 120,
      //     tree: true,
      //     label: "Task Name",
      //     resize: true,
      //     template: (task) => {
      //       return `<span>${task.text}</span>`;
      //     },
      //   },
      //   {
      //     name: "text",
      //     width: 245,
      //     min_width: 80,
      //     max_width: 120,
      //     tree: false,
      //     align: "center",
      //     label: "Task Name",
      //     resize: true,
      //     template: (task) => {
      //       return `<span>${task.text}</span>`;
      //     },
      //   },
      // ];

      function weekStartAndEnd(t) {
        const e = t.getDay();
        let a, n;
        0 === e
          ? ((a = ZT_Gantt.add(t, -6, "day")), (n = t))
          : ((a = ZT_Gantt.add(t, -1 * e + 1, "day")),
            (n = ZT_Gantt.add(t, 7 - e, "day")));
        return {
          startDate: a,
          endDate: n,
          weekNum: ZT_Gantt.formatDateToString("%W", t),
        };
      }

      ZT_Gantt.options.startDate = "2023-09-01T11:46:17.775Z";
      ZT_Gantt.options.endDate = "2023-09-15T11:46:17.775Z";

      ZT_Gantt.templates.tooltip_text = function (start, end, task) {
        return `<b>${task.parent === 0 ? "Project" : "Task"}:</b>
            ${task.text}
            <br/><b>Start date:</b>
            ${ZT_Gantt.formatDateToString("%d-%m-%y %H:%i", start)}
            <br/><b>End date:</b>
            ${ZT_Gantt.formatDateToString("%d-%m-%y %H:%i", end)}<br/>
            <b>Duration:</b> ${task.duration} ${
          task.duration > 1 ? "Days" : "Day"
        }`;
      };

      ZT_Gantt.templates.taskbar_text = function (start, end, task) {
        if (task.parent == 0 && task.type !== "milestone") {
          return `Project : ${task.text}`;
        } else if (task.type === "milestone") {
          return task.text;
        } else {
          return `Task : ${task.text}`;
        }
      };

      ZT_Gantt.templates.grid_folder = (task) => {
        var name = task?.text?.trim().split(" ");
        var firstname = name?.[0];
        var lastname = name?.[1] ? name?.[1] : "";
        var intials =
          firstname?.charAt(0)?.toUpperCase() +
          lastname?.charAt(0)?.toUpperCase();
        return `<div></div>`;
      };

      ZT_Gantt.templates.grid_file = (task) => {
        if (task.parent != 0) {
          var tracker_name = task.hasOwnProperty("tracker")
            ? task.tracker.name
            : " ";
          let issue_id = task.id;
          return `<div class='gantt_file ${tracker_name}'><a  class="link-issue ${tracker_name}" href='http://127.0.0.1:5500//issues/${issue_id}'>#${issue_id}</a></div>`;
        }
      };

      ZT_Gantt.templates.task_drag = (mode, task) => {
        if (task.parent == 0 || (task.children && task.children.length > 0)) {
          // || task.children
          return false;
        }
        return true;
      };

      // add custom classes
      // ZT_Gantt.templates.grid_header_class = (columns,i) => {
      //   return "my-header-class test"
      // }
      // ZT_Gantt.templates.grid_row_class = (start, end, task) => {
      //   console.log(start, end);
      //   return "my-grid-row-class test"
      // }
      ZT_Gantt.templates.task_class = (start, end, task) => {
        if (task.parent == 0) {
          return "parent-task";
        } else {
          return "child-task";
        }
      };
      // ZT_Gantt.templates.task_row_class = (start, end, task) => {
      //   return "my-task-row-class test"
      // }
      ZT_Gantt.templates.scale_cell_class = (date, scale, scaleIndex) => {
        if (scaleIndex === 1) {
          return "my-scale-class-2";
        } else {
          return "";
        }
      };
      // ZT_Gantt.templates.grid_cell_class = (col, task) => {
      //   return "my-grid-cell-class test"
      // }
      // ZT_Gantt.templates.timeline_cell_class = (task, date) => {
      //   return "my-task-cell-class  Test  "
      // }

      // add custom marker
      ZT_Gantt.addMarker({
        start_date: ZT_Gantt.add(new Date(), 1, "day"), //a Date object that sets the marker's date
        css: "tomorrow", //a CSS class applied to the marker
        text: "Tomorrow", //the marker title
        title: ZT_Gantt.formatDateToString(
          "%d %F %y",
          ZT_Gantt.add(new Date(), 1, "day")
        ), // the marker's tooltip
      });

      // ZT_Gantt.addMarker({
      //   start_date: ZT_Gantt.add(new Date(),-1, "day"), //a Date object that sets the marker's date
      //   css: "yesterday", //a CSS class applied to the marker
      //   text: "Yesterday", //the marker title
      //   title: ZT_Gantt.formatDateToString("%d %F %Y", ZT_Gantt.add(new Date(),-1, "day")), // the marker's tooltip
      // });

      // render gantt
      ZT_Gantt.render(element);

      // console.log(ZT_Gantt);

      // to find task in gantt
      // console.log(ZT_Gantt.getTask(69));

      // custom events
      ZT_Gantt.attachEvent("onTaskDblClick", (event) => {
        // console.log("onTaskDblClick: ", event);
      });
      let idCount = 0;
      ZT_Gantt.attachEvent("addTaskOnDrag", (event) => {
        // console.log("addTaskOnDrag: ", event.task);
        ZT_Gantt.addTask({
          id: "Added" + idCount,
          start_date: new Date(event.task.startDate),
          end_date: new Date(event.task.endDate),
          parent: event.task.parent,
          text: "Task Added",
        });
        ZT_Gantt.render();
        idCount += 1;
      });
      ZT_Gantt.attachEvent("onLinkDblClick", (event) => {
        // console.log("onLinkDblClick: ", event);
      });
      ZT_Gantt.attachEvent("onBeforeLinkAdd", (event) => {
        // console.log("onBeforeLinkAdd: ", event);
      });
      ZT_Gantt.attachEvent("onLinkAdd", (event) => {
        // console.log("onLinkAdd: ", event);
      });
      ZT_Gantt.attachEvent("onDeleteLink", (event) => {
        // console.log("onDeleteLink: ", event);
      });
      ZT_Gantt.attachEvent("onBeforeTaskDrag", (event) => {
        // console.log("onBeforeTaskDrag: ", event);
        if (event.task.children.length !== 0) {
          return false;
        } else {
          return true;
        }
      });
      ZT_Gantt.attachEvent("onTaskDrag", (event) => {
        // console.log("onTaskDrag: ", event);
      });
      ZT_Gantt.attachEvent("onAfterTaskDrag", (event) => {
        console.log("onAfterTaskDrag: ", event);
        console.log("onAfterTaskDrag: ", ZT_Gantt.options.data);
      });
      ZT_Gantt.attachEvent("onBeforeTaskDrop", (event) => {
        console.log("onBeforeTaskDrop: ", event);
        if (event.parentTask.id == 12) {
          return false;
        }
      });
      ZT_Gantt.attachEvent("onTaskToggle", (event) => {
        // console.log("onTaskToggle: ", event);
      });

      ZT_Gantt.attachEvent("onTaskDelete", (event) => {
        // console.log("onTaskDelete: ", event);
      });
      ZT_Gantt.attachEvent("onAfterTaskUpdate", (event) => {
        // console.log("onAfterTaskUpdate: ", event);
      });
      ZT_Gantt.attachEvent("onCellClick", (event) => {
        // console.log("onCellClick: ", event);
      });
      ZT_Gantt.attachEvent("onExpand", (event) => {
        // console.log("onExpand: ", event);
      });
      ZT_Gantt.attachEvent("onCollapse", (event) => {
        // console.log("onCollapse: ", event);
      });
      ZT_Gantt.attachEvent("onScroll", (event) => {
        // console.log("onScroll: ", event);
        ZT_Gantt.clearAll();
        let newData=[
        {
          id: "n2",
          text: "new Task #2",
          start_date: "09-05-2023",
          end_date: "09-05-2023",
          parent: 1,
          progress: 50,
        },
        {
          id: "n23",
          text: "new Final Milestone",
          start_date: "09-17-2023",
          end_date: "09-17-2023",
          parent: 1,
          type: "milestone",
        },
        {
          id: 23,
          text: "Dupli.. Final Milestone",
          start_date: "09-17-2023",
          end_date: "09-17-2023",
          parent: 1,
          type: "milestone",
        },
        ]
        ZT_Gantt.parse(newData);
        ZT_Gantt.options.collapse = false
        ZT_Gantt.render();
      });
      // ZT_Gantt.attachEvent("onResize", (event) => {
      //   console.log("onResize: ", event);
      // });
      ZT_Gantt.attachEvent("onAfterProgressDrag", (event) => {
        // console.log("onAfterProgressDrag: ", event);
      });
      ZT_Gantt.attachEvent("onBeforeProgressDrag", (event) => {
        // console.log("onBeforeProgressDrag: ", event);
        // if(event.task.parent === 0){
        //   return false;
        // }else{
        //   return true;
        // }
      });
      ZT_Gantt.attachEvent("onAutoScheduling", (event) => {
        // console.log("onAutoScheduling: ", event);
      });
      ZT_Gantt.attachEvent("onColorChange", (event) => {
        // console.log("onColorChange: ", event);
      });
      ZT_Gantt.attachEvent("onBeforeTaskDblClick", (event) => {
        // console.log("onColorChange: ", event);
        // if(event.task.id === 3){
        //   return false;
        // }
      });

      let fullscreen = false;
      function changeScreen() {
        if (fullscreen === false) {
          ZT_Gantt.requestFullScreen();
          // ZT_Gantt.openTask(5);
        } else {
          ZT_Gantt.exitFullScreen();
        }
      }

      function changeZoom(e) {
        ZT_Gantt.options.zoomLevel = e.target.value;
        if (e.target.value === "month" || e.target.value === "quarter") {
          ZT_Gantt.options.startDate = "2023-01-01T11:46:17.775Z";
          ZT_Gantt.options.endDate = "2023-12-31T11:46:17.775Z";
        } else if (e.target.value === "year") {
          ZT_Gantt.options.startDate = "2022-01-01T11:46:17.775Z";
          ZT_Gantt.options.endDate = "2024-12-31T11:46:17.775Z";
        } else {
          ZT_Gantt.options.startDate = "2023-09-01T11:46:17.775Z";
          ZT_Gantt.options.endDate = "2023-09-30T11:46:17.775Z";
        }
        ZT_Gantt.zoomInit();
      }

      function changeLang(e) {
        ZT_Gantt.setLocalLang(e.target.value);
      }

      function changeCollapse(e) {
        if (e.target.checked === true) {
          ZT_Gantt.collapseAll();
        } else {
          ZT_Gantt.expandAll();
        }
      }

      function changeToday(e) {
        if (event.target.checked === true) {
          ZT_Gantt.addTodayFlag();
        } else {
          ZT_Gantt.removeTodayFlag();
        }
      }

      function exportChange(e) {
        let stylesheet = [
          "https://zehntech.github.io/zt-gantt/gantt.css",
          "https://zehntech.github.io/zt-gantt/style.css",
        ];
        if (e.target.value === "png") {
          ZT_Gantt.exportToPNG("ztGanttChart", stylesheet);
        } else if (e.target.value === "pdf") {
          ZT_Gantt.exportToPDF("ztGanttChart", stylesheet);
        } else {
          ZT_Gantt.exportToExcel("ztGanttChart");
        }
        e.target.value = "";
      }

      function autoScheduling() {
        ZT_Gantt.autoScheduling();
      }
      function addTask() {
        ZT_Gantt.addTask({
          id: 5354653546,
          tracker_id: 4,
          project_id: 86,
          subject:
            "Workflow - In the Workflow view, JOC reacts slow when handling large workflows or multiple smaller workflows in the same folder.",
          description:
            "requirements-\r\nwhen in the WORKFLOW view a larger workflow (several hundred jobs) or multiple smaller workflows in the same folder are completely expanded then JOC reacts rather slowly.\r\nThis affects actions like scrolling, opening instruction and order menus and executing items of these menus.",
          due_date: "2023-05-17",
          category_id: null,
          status_id: 2,
          assigned_to_id: 308,
          priority_id: 2,
          fixed_version_id: null,
          author_id: 308,
          lock_version: 3,
          created_on: "2023-05-18T05:03:17.000Z",
          updated_on: "2023-05-18T05:03:25.000Z",
          start_date: "2023-05-17",
          done_ratio: 70,
          estimated_hours: 8.5,
          parent: 12,
          parent_id: null,
          root_id: 53546,
          lft: 1,
          rgt: 2,
          is_private: false,
          closed_on: null,
          tag_list: [],
        });
        // setTimeout(()=>{

          // ZT_Gantt.openTask(5);
        // },0)
        // ZT_Gantt.parse(data);
        ZT_Gantt.render();
        // ZT_Gantt.deleteLink(1);
      }

      // get the position of the cell
      // console.log(ZT_Gantt.posFromDate(new Date()));

      // iterate over each task
      // ZT_Gantt.eachTask((task)=>{
      //   console.log(task._id,"task _id ?????????????????????????????????");
      // })
      let cssStyle;
      let root = document.querySelector(":root");
      function changeTheme(event) {
        if (event.target.checked) {
          cssStyle = document.createElement("link");
          cssStyle.setAttribute("rel", "stylesheet");
          cssStyle.setAttribute("href", "./theme/dark.css");
          document.getElementsByTagName("head")[0].append(cssStyle);

          root.style.setProperty("--bg-color", "#333332");
          root.style.setProperty("--text-color", "#fff");
          root.style.setProperty("--text-secondary-color", "#fff");
          root.style.setProperty("--index-primary-color", "#1395BE");
          root.style.setProperty("--index-primary-hover-color", "#0E7595");
        } else {
          cssStyle.remove();
          root.style.setProperty("--bg-color", "#fff");
          root.style.setProperty("--text-color", "#000");
          root.style.setProperty("--text-secondary-color", "#fff");
          root.style.setProperty("--index-primary-color", "#4ca0fff2");
          root.style.setProperty("--index-primary-hover-color", "#3585e0f2");
        }
      }

      let getScale = () => {
        console.log(ZT_Gantt.getScale());
      };

      function searchTask(e) {
        let isFilter = e.target.value.trim() !== "";
        ZT_Gantt.filterTask((task) => {
          return task.text.toLowerCase().includes(e.target.value.toLowerCase());
        }, isFilter, true);
      }
      function addCol() {
        ZT_Gantt.options.columns.push({
          name: "progress",
          width: 245,
          min_width: 80,
          max_width: 300,
          tree: false,
          label: "Progress",
          resize: true,
          align: "center",
          template: (task) => {
            return `<span>${task.progress || 0}</span>`;
          },
        });
        ZT_Gantt.render();
      }

      function removeCol() {
        ZT_Gantt.options.columns.splice(ZT_Gantt.options.columns.length - 1, 1);
        ZT_Gantt.render();
      }

      function startTour() {
        let options = {
          overlayOpacity: 0.7,
          stagePadding: 10,
          stageRadius: 5,
          overlayColor: "#000",
          animate: true,
          smoothScroll: true,
          allowBackdropClose: true,
          popupClass: "popupClass",
          keyboardControl: true,
          showProgress: true,
          visibleButtons: ['next', 'previous', 'close'],
          disableButtons: [],
          animationDuration: 400,
          onNextClick: (step)=>{
            console.log(step, " Next Click");
          },
          onClose: ()=>{
            console.log("Tour Closed");
          },
          onPreviousClick: (step)=>{
            console.log(step, " Previous Click");
          },
          steps: [
            {
              element: ".collapse-container",
              popup: {
                title: "Toggle Collapse",
                description: "Toggle all the Tasks!!",
                side: "bottom",
                align: "start",
              },
            },
            {
              element: ".today-container",
              popup: {
                title: "Toggle Marker",
                description: "Toggle Today Marker!!",
                side: "bottom",
                align: "start",
              },
            },
            {
              element: ".export-data",
              popup: {
                title: "Export Chart",
                description: "Get your charts in PDF, PNG, or Excel formats",
                side: "bottom",
                align: "center",
              },
            },
            {
              element: ".fullscreen",
              popup: {
                title: "Full Screen",
                description: "View your Gantt in full screen for an immersive experience",
                side: "bottom",
                align: "end",
              },
            },
            {
              element: ".auto-scheduling",
              popup: {
                title: "Auto Scheduling",
                description: "Tasks are automatically scheduled.",
                side: "bottom",
                align: "center",
              },
            },
            {
              element: ".zoom",
              popup: {
                title: "Zoom Levels",
                description: "Multiple timeline views - hour, day, week, month, quarter, and year.",
                side: "bottom",
                align: "end",
              },
            },
            {
              element: ".Language",
              popup: {
                title: "Change Language",
                description: "Change language of the gantt chart.",
                side: "bottom",
                align: "end",
              },
            },
            {
              element: ".dark-mode",
              popup: {
                title: "Toggle Dark Mode",
                description: "Dark mode for those late-night work sessions.",
                side: "bottom",
                align: "end",
              },
            },
            {
              element: ".gantt-search",
              popup: {
                title: "Search Tasks",
                description: "Search Tasks to quickly find and access tasks based on your search criteria. Streamline your workflow by searching for specific tasks with ease.",
                side: "bottom",
                align: "end",
              },
            },
            {
              element: "#ZT-Gantt",
              popup: {
                title: "Gantt Chart",
                description: "The Gantt Chart view provides a visual representation of project tasks and their timelines, allowing you to efficiently manage project schedules, dependencies, and progress. Easily track and plan tasks, making project management a seamless experience.",
                side: "top",
                align: "start",
              },
            },
            {
              popup: {
                title: "That's everything",
                description: `<div class="finish">
                  <p>Looks like you're ready to go 🎉</p>
                  <p>Click anywhere to exit the tour.</p>
                  <img src="https://media.tenor.com/y2JXkY1pXkwAAAAM/cat-computer.gif">
                  </div>`,
                side: "over",
                align: "over",
              },
            },
          ],
        };
        let tour = new ztTour(options);
        // console.log(ztTour,"ztTour");
        tour.start();
      }

      document.querySelector(".hint-icon").removeEventListener("click",handleClick);
      document.querySelector(".hint-icon").addEventListener("click",handleClick);
      
      let tour = new ztTour({});
      function handleClick(e){
          tour.showHint({
            element: ".hint-icon",
            innerHTML: `<p>Click on "Start Tour" to start the tour.</p>`
          });
        }
        let intro = `
        <h2 style="font-size: 18px; margin-bottom: 5px; font-weight: 600; text-align:center">ztGantt Chart</h2>
        <p style="line-height: 18px; text-align: justify;margin-bottom: 5px;">Welcome to the ztGantt Chart Library. 
          This library provides a powerful set of tools and functionalities to create interactive Gantt charts for project management. This documentation will guide you through the installation process, 
          usage instructions, and available features of the library.</p>
          <p>Click on "Start Tour" to start the tour.</p>
          `;
      // tour.showAnnouncement(intro);
    </script>

  </body>
</html>
